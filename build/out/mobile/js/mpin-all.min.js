function createXMLHttp(){if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if(window.ActiveXObject)for(var a=["MSXML2.XMLHttp.5.0","MSXML2.XMLHttp.4.0","MSXML2.XMLHttp.3.0","MSXML2.XMLHttp","Microsoft.XMLHttp"],b=0;b<a.length;b++)try{var c=new ActiveXObject(a[b]);return c}catch(d){throw new Error("XMLHttp object could be created.")}throw new Error("XMLHttp object could be created.")}function extractPIN(a,b,c,d){var e=_MPinToken(a,b,c);d(e)}function _MPinToken(a,b,c){var d=a,e=hex2pointFormat(b),f=new ecc.point.fromString(e,idak._curve),g=util.bytesToUnicode(util.bitsToBytes(util.hexToBitsNew(c))),h=idak._hashToPoint1(util.unicodeToBytes(g)),i=f.sub(h.smul(parseInt(d,10))).toString(),j=pointFormat2hex(i);return j}function reset_format(a){var b=util.bitsToBytes(util.stringToBits(a));b=util.fixBytesLen(b,2*idak.FS+1);var c=b.slice(1,idak.FS+1);c=util.bitsToString(util.bytesToBits(c));var d=b.slice(idak.FS+1);return d=util.bitsToString(util.bytesToBits(d)),"["+c+","+d+"]"}function hex2pointFormat(a){var b=util.bitsToBytes(util.hexToBitsNew(a));b=util.fixBytesLen(b,2*idak.FS+1);var c=b.slice(1,idak.FS+1);c=util.bitsToString(util.bytesToBits(c));var d=b.slice(idak.FS+1);return d=util.bitsToString(util.bytesToBits(d)),"["+c+","+d+"]"}function change_format(a){var b=a.indexOf(","),c=util.bitsToBytes(util.stringToBits(a.substring(1,b))),d=util.bitsToBytes(util.stringToBits(a.substring(b+1,a.length-1)));c=util.fixBytesLen(c,idak.FS),d=util.fixBytesLen(d,idak.FS);var e=[4];return e=e.concat(c).concat(d),util.bitsToString(util.bytesToBits(e))}function pointFormat2hex(a){var b=a.indexOf(","),c=util.bitsToBytes(util.stringToBits(a.substring(1,b))),d=util.bitsToBytes(util.stringToBits(a.substring(b+1,a.length-1)));c=util.fixBytesLen(c,idak.FS),d=util.fixBytesLen(d,idak.FS);var e=[4];return e=e.concat(c).concat(d),util.bitsToHexNew(util.bytesToBits(e))}function getAuthToken(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=_randomX(h),p=c,q=!1,r=!1;setTimeout(function(){q||r||(r=!0,console.error("Websocket connection timeout. Will use AJAX."),m(!1,"WEBSOCKETERROR","WEB SOCKET ERROR"))},5e3);var s=new WebSocket(a);s.onerror=function(){s.close(),r=!0,m(!1,"WEBSOCKETERROR","WEB SOCKET ERROR")},s.onopen=function(){var a=_pass1Request(o,p);s.send(JSON.stringify(a))},s.onclose=function(){},s.onmessage=function(a){var b=JSON.parse(a.data);if(1==b.pass){if(q=!0,r)return;var c=_pass2Request(o,b.y,p,d,e,f,g,i);s.send(JSON.stringify(c))}else if(2==b.pass){var b=JSON.parse(a.data);s.close(),sendAuthToken(j,b,m,k,l,n)}else s.close()}}function getAuthTokenAjax(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=a.mpin_endsWith("/")?a.slice(0,a.length-1):a;o=a.split("/authenticationToken").join("");var p=o.split("://");"wss"==p[0]?p[0]="https":"ws"==p[0]&&(p[0]="http"),o=p.join("://");var q=o+"/pass1",r=o+"/pass2",s=createXMLHttp(),t=_randomX(h),u=c,v=_pass1Request(t,u),w=JSON.stringify(v),x="application/json";s.onreadystatechange=function(){if(4==s.readyState)if(200==s.status){var a=s.responseText,b=JSON.parse(a),c=_pass2Request(t,b.y,u,d,e,f,g,i);c.IDc=u;var h=JSON.stringify(c),o=createXMLHttp();o.onreadystatechange=function(){if(4==o.readyState)if(200==o.status){var a=o.responseText,b=JSON.parse(a);sendAuthToken(j,b,m,k,l,n)}else console.error("Error PASS2 on Ajax Authentication Request: "+xmlhttpPass2.status)},o.open("POST",r,!0),o.setRequestHeader("Content-Type",x);for(var p in l)o.setRequestHeader(p,l[p]);o.send(h)}else console.error("Error PASS1 on Ajax Authentication Request: "+xmlhttpAuthToken.status)},s.open("POST",q,!0),s.setRequestHeader("Content-Type",x);for(var y in l)s.setRequestHeader(y,l[y]);s.send(w)}function sendAuthToken(a,b,c,d,e,f){var g,h="application/json",i={mpinResponse:b};d&&(i=d(i));var j=JSON.stringify(i),g=createXMLHttp();g.onreadystatechange=function(){if(4==g.readyState)if(200==g.status){var a=g.responseText,b=JSON.parse(a);f&&f(b),c(!0,"OK","Authenticated",b)}else 401==g.status?c(!1,"INVALID","INVALID PIN"):403==g.status?c(!1,"NOTAUTHORIZED","You are not authorized!"):410==g.status?c(!1,"MAXATTEMPTS","Max Attempts Reached"):412==g.status?c(!1,"INVALIDACCESSNUMBER","Invalid Access Number"):c(!1,"INVOCATION","Invocation Errors Occured "+g.readyState+" and the status is "+g.status)},g.open("POST",a,!0),g.setRequestHeader("Content-Type",h);for(var k in e)g.setRequestHeader(k,e[k]);g.send(j)}function requestSignature(a,b,c,d,e,f){var g="application/json",h=c+"?userid="+encodeURIComponent(a)+"&mobile="+b,i=createXMLHttp();i.onreadystatechange=function(){if(4==i.readyState)if(200==i.status){var a=i.responseText,b=JSON.parse(a);e(b)}else 401==i.status||403==i.status?f("Error getting the mpin signature",i.status):f("Error getting the mpin signature",i.status)},i.open("GET",h,!0),i.setRequestHeader("Content-Type",g);for(var j in d)i.setRequestHeader(j,d[j]);i.send()}function requestRegister(a,b,c,d,e,f){d||(d=function(a){return a});var g=JSON.stringify(d({identity:b})),h=createXMLHttp();h.onreadystatechange=function(){4==h.readyState&&(200==h.status?e():f(h.responseText,h.status))},h.open("POST",a,!0),h.setRequestHeader("Content-Type","application/json");for(var i in c)h.setRequestHeader(i,c[i]);h.send(g)}function requestClientSecretShare(a,b,c,d){var e,f="application/json",e=createXMLHttp();e.onreadystatechange=function(){if(4==e.readyState)if(200==e.status){var a=e.responseText,b=JSON.parse(a);c(b.clientSecret)}else if(401==e.status||403==e.status){var a=e.responseText,b=JSON.parse(a);d("Error getting the client secret: "+e.status,e.status)}else d("Error getting the client secret: "+e.status,e.status)},e.open("GET",a,!0),e.setRequestHeader("Content-Type",f);for(var g in b)e.setRequestHeader(g,b[g]);e.send()}function requestClientSecret(a,b,c,d,e){requestClientSecretShare(a,{},function(a){requestClientSecretShare(b,c,function(b){var c=addShares(a,b);d(c)},e)},e)}function addShares(a,b){var c=hex2pointFormat(a),d=new ecc.point.fromString(c,idak._curve),e=hex2pointFormat(b),f=new ecc.point.fromString(e,idak._curve),g=d.add(f).toString(),h=pointFormat2hex(g);return h}function requestTimePermitShare(a,b,c,d){var e,f="application/json",e=createXMLHttp();e.onreadystatechange=function(){if(4==e.readyState)if(200==e.status){var a=e.responseText,b=JSON.parse(a);c(b.timePermit)}else if(403==e.status){var a=e.responseText,b=JSON.parse(a);d(b,e.status)}else{var a=e.responseText,b=JSON.parse(a);d(b,e.status)}},e.open("GET",a,!0),e.setRequestHeader("Content-Type",f);for(var g in b)e.setRequestHeader(g,b[g]);e.send()}function requestTimePermit(a,b,c,d,e){requestTimePermitShare(a,{},function(a){requestTimePermitShare(b,c,function(b){var c=addShares(a,b);d(c)},e)},e)}function _randomX(a){var b=util.bitsToBytes(util.hexToBitsNew(a));cjct.random.addEntropy(b);var c=idak.getSecret();return c}function _pass1Request(a,b){var c=util.bytesToUnicode(util.bitsToBytes(util.hexToBitsNew(b))),d=idak._hashToPoint1(util.unicodeToBytes(c)),e=idak._hashToPoint1(util.wordToBytes(util.today()).concat(util.unicodeToBytes(c))),f=idak.computeMPin_1x(d,a),g=pointFormat2hex(f),h=idak.computeMPin_1c(d,e,a),i=pointFormat2hex(h),j={IDc:b,UT:i,U:g,pass:1};return j}function _pass2Request(a,b,c,d,e,f,g,h){var i=util.bytesToUnicode(util.bitsToBytes(util.hexToBitsNew(c))),j=idak._hashToPoint1(util.unicodeToBytes(i)),k=hex2pointFormat(d),l=hex2pointFormat(e),m=new bn(util.bitsToHex(util.hexToBitsNew(b))),n=idak._curve.r,o=m.add(a).mod(n);o=n.sub(o).normalize(),V=idak.computeMPin_1b(j,o,h,l,k);var p=pointFormat2hex(V),q={V:p,OTP:f,WID:g,pass:2};return q}function pass1(a,b,c,d,e,f,g,h,i,j,k,l,m){var n,o=_randomX(g),p=b,q=_pass1Request(o,p),r=JSON.stringify(q),s="application/json";n=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),n.onreadystatechange=function(){if(4==n.readyState)if(200==n.status){var b=n.responseText,g=JSON.parse(b);pass2(a,o,g.y,p,c,d,e,f,h,i,j,k,l,m)}else 500==n.status},n.open("POST",a,!0),n.setRequestHeader("Content-Type",s),n.send(r)}function pass2(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o=_pass2Request(b,c,d,e,f,g,h,i);o.IDc=d;var p,q=JSON.stringify(o),r="application/json";p=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),p.onreadystatechange=function(){if(4==p.readyState)if(200==p.status){var a=p.responseText,b=JSON.parse(a);sendAuthToken(j,b,m,k,l,n)}else 500==p.status},p.open("POST",a,!0),p.setRequestHeader("Content-Type",r),p.send(q)}var QRCode;!function(){function a(a){this.mode=j.MODE_8BIT_BYTE,this.data=a,this.parsedData=[];for(var b=[],c=0,d=this.data.length;d>c;c++){var e=this.data.charCodeAt(c);e>65536?(b[0]=240|(1835008&e)>>>18,b[1]=128|(258048&e)>>>12,b[2]=128|(4032&e)>>>6,b[3]=128|63&e):e>2048?(b[0]=224|(61440&e)>>>12,b[1]=128|(4032&e)>>>6,b[2]=128|63&e):e>128?(b[0]=192|(1984&e)>>>6,b[1]=128|63&e):b[0]=e,this.parsedData=this.parsedData.concat(b)}this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function b(a,b){this.typeNumber=a,this.errorCorrectLevel=b,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function c(a,b){if(void 0==a.length)throw new Error(a.length+"/"+b);for(var c=0;c<a.length&&0==a[c];)c++;this.num=new Array(a.length-c+b);for(var d=0;d<a.length-c;d++)this.num[d]=a[d+c]}function d(a,b){this.totalCount=a,this.dataCount=b}function e(){this.buffer=[],this.length=0}function f(){return"undefined"!=typeof CanvasRenderingContext2D}function g(){var a=!1,b=navigator.userAgent;return/android/i.test(b)&&(a=!0,aMat=b.toString().match(/android ([0-9]\.[0-9])/i),aMat&&aMat[1]&&(a=parseFloat(aMat[1]))),a}function h(a,b){for(var c=1,d=i(a),e=0,f=p.length;f>=e;e++){var g=0;switch(b){case k.L:g=p[e][0];break;case k.M:g=p[e][1];break;case k.Q:g=p[e][2];break;case k.H:g=p[e][3]}if(g>=d)break;c++}if(c>p.length)throw new Error("Too long data");return c}function i(a){var b=encodeURI(a).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return b.length+(b.length!=a?3:0)}a.prototype={getLength:function(){return this.parsedData.length},write:function(a){for(var b=0,c=this.parsedData.length;c>b;b++)a.put(this.parsedData[b],8)}},b.prototype={addData:function(b){var c=new a(b);this.dataList.push(c),this.dataCache=null},isDark:function(a,b){if(0>a||this.moduleCount<=a||0>b||this.moduleCount<=b)throw new Error(a+","+b);return this.modules[a][b]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(a,c){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var d=0;d<this.moduleCount;d++){this.modules[d]=new Array(this.moduleCount);for(var e=0;e<this.moduleCount;e++)this.modules[d][e]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(a,c),this.typeNumber>=7&&this.setupTypeNumber(a),null==this.dataCache&&(this.dataCache=b.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,c)},setupPositionProbePattern:function(a,b){for(var c=-1;7>=c;c++)if(!(-1>=a+c||this.moduleCount<=a+c))for(var d=-1;7>=d;d++)-1>=b+d||this.moduleCount<=b+d||(this.modules[a+c][b+d]=c>=0&&6>=c&&(0==d||6==d)||d>=0&&6>=d&&(0==c||6==c)||c>=2&&4>=c&&d>=2&&4>=d?!0:!1)},getBestMaskPattern:function(){for(var a=0,b=0,c=0;8>c;c++){this.makeImpl(!0,c);var d=m.getLostPoint(this);(0==c||a>d)&&(a=d,b=c)}return b},createMovieClip:function(a,b,c){var d=a.createEmptyMovieClip(b,c),e=1;this.make();for(var f=0;f<this.modules.length;f++)for(var g=f*e,h=0;h<this.modules[f].length;h++){var i=h*e,j=this.modules[f][h];j&&(d.beginFill(0,100),d.moveTo(i,g),d.lineTo(i+e,g),d.lineTo(i+e,g+e),d.lineTo(i,g+e),d.endFill())}return d},setupTimingPattern:function(){for(var a=8;a<this.moduleCount-8;a++)null==this.modules[a][6]&&(this.modules[a][6]=0==a%2);for(var b=8;b<this.moduleCount-8;b++)null==this.modules[6][b]&&(this.modules[6][b]=0==b%2)},setupPositionAdjustPattern:function(){for(var a=m.getPatternPosition(this.typeNumber),b=0;b<a.length;b++)for(var c=0;c<a.length;c++){var d=a[b],e=a[c];if(null==this.modules[d][e])for(var f=-2;2>=f;f++)for(var g=-2;2>=g;g++)this.modules[d+f][e+g]=-2==f||2==f||-2==g||2==g||0==f&&0==g?!0:!1}},setupTypeNumber:function(a){for(var b=m.getBCHTypeNumber(this.typeNumber),c=0;18>c;c++){var d=!a&&1==(1&b>>c);this.modules[Math.floor(c/3)][c%3+this.moduleCount-8-3]=d}for(var c=0;18>c;c++){var d=!a&&1==(1&b>>c);this.modules[c%3+this.moduleCount-8-3][Math.floor(c/3)]=d}},setupTypeInfo:function(a,b){for(var c=this.errorCorrectLevel<<3|b,d=m.getBCHTypeInfo(c),e=0;15>e;e++){var f=!a&&1==(1&d>>e);6>e?this.modules[e][8]=f:8>e?this.modules[e+1][8]=f:this.modules[this.moduleCount-15+e][8]=f}for(var e=0;15>e;e++){var f=!a&&1==(1&d>>e);8>e?this.modules[8][this.moduleCount-e-1]=f:9>e?this.modules[8][15-e-1+1]=f:this.modules[8][15-e-1]=f}this.modules[this.moduleCount-8][8]=!a},mapData:function(a,b){for(var c=-1,d=this.moduleCount-1,e=7,f=0,g=this.moduleCount-1;g>0;g-=2)for(6==g&&g--;;){for(var h=0;2>h;h++)if(null==this.modules[d][g-h]){var i=!1;f<a.length&&(i=1==(1&a[f]>>>e));var j=m.getMask(b,d,g-h);j&&(i=!i),this.modules[d][g-h]=i,e--,-1==e&&(f++,e=7)}if(d+=c,0>d||this.moduleCount<=d){d-=c,c=-c;break}}}},b.PAD0=236,b.PAD1=17,b.createData=function(a,c,f){for(var g=d.getRSBlocks(a,c),h=new e,i=0;i<f.length;i++){var j=f[i];h.put(j.mode,4),h.put(j.getLength(),m.getLengthInBits(j.mode,a)),j.write(h)}for(var k=0,i=0;i<g.length;i++)k+=g[i].dataCount;if(h.getLengthInBits()>8*k)throw new Error("code length overflow. ("+h.getLengthInBits()+">"+8*k+")");for(h.getLengthInBits()+4<=8*k&&h.put(0,4);0!=h.getLengthInBits()%8;)h.putBit(!1);for(;!(h.getLengthInBits()>=8*k)&&(h.put(b.PAD0,8),!(h.getLengthInBits()>=8*k));)h.put(b.PAD1,8);return b.createBytes(h,g)},b.createBytes=function(a,b){for(var d=0,e=0,f=0,g=new Array(b.length),h=new Array(b.length),i=0;i<b.length;i++){var j=b[i].dataCount,k=b[i].totalCount-j;e=Math.max(e,j),f=Math.max(f,k),g[i]=new Array(j);for(var l=0;l<g[i].length;l++)g[i][l]=255&a.buffer[l+d];d+=j;var n=m.getErrorCorrectPolynomial(k),o=new c(g[i],n.getLength()-1),p=o.mod(n);h[i]=new Array(n.getLength()-1);for(var l=0;l<h[i].length;l++){var q=l+p.getLength()-h[i].length;h[i][l]=q>=0?p.get(q):0}}for(var r=0,l=0;l<b.length;l++)r+=b[l].totalCount;for(var s=new Array(r),t=0,l=0;e>l;l++)for(var i=0;i<b.length;i++)l<g[i].length&&(s[t++]=g[i][l]);for(var l=0;f>l;l++)for(var i=0;i<b.length;i++)l<h[i].length&&(s[t++]=h[i][l]);return s};for(var j={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},k={L:1,M:0,Q:3,H:2},l={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},m={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(a){for(var b=a<<10;m.getBCHDigit(b)-m.getBCHDigit(m.G15)>=0;)b^=m.G15<<m.getBCHDigit(b)-m.getBCHDigit(m.G15);return(a<<10|b)^m.G15_MASK},getBCHTypeNumber:function(a){for(var b=a<<12;m.getBCHDigit(b)-m.getBCHDigit(m.G18)>=0;)b^=m.G18<<m.getBCHDigit(b)-m.getBCHDigit(m.G18);return a<<12|b},getBCHDigit:function(a){for(var b=0;0!=a;)b++,a>>>=1;return b},getPatternPosition:function(a){return m.PATTERN_POSITION_TABLE[a-1]},getMask:function(a,b,c){switch(a){case l.PATTERN000:return 0==(b+c)%2;case l.PATTERN001:return 0==b%2;case l.PATTERN010:return 0==c%3;case l.PATTERN011:return 0==(b+c)%3;case l.PATTERN100:return 0==(Math.floor(b/2)+Math.floor(c/3))%2;case l.PATTERN101:return 0==b*c%2+b*c%3;case l.PATTERN110:return 0==(b*c%2+b*c%3)%2;case l.PATTERN111:return 0==(b*c%3+(b+c)%2)%2;default:throw new Error("bad maskPattern:"+a)}},getErrorCorrectPolynomial:function(a){for(var b=new c([1],0),d=0;a>d;d++)b=b.multiply(new c([1,n.gexp(d)],0));return b},getLengthInBits:function(a,b){if(b>=1&&10>b)switch(a){case j.MODE_NUMBER:return 10;case j.MODE_ALPHA_NUM:return 9;case j.MODE_8BIT_BYTE:return 8;case j.MODE_KANJI:return 8;default:throw new Error("mode:"+a)}else if(27>b)switch(a){case j.MODE_NUMBER:return 12;case j.MODE_ALPHA_NUM:return 11;case j.MODE_8BIT_BYTE:return 16;case j.MODE_KANJI:return 10;default:throw new Error("mode:"+a)}else{if(!(41>b))throw new Error("type:"+b);switch(a){case j.MODE_NUMBER:return 14;case j.MODE_ALPHA_NUM:return 13;case j.MODE_8BIT_BYTE:return 16;case j.MODE_KANJI:return 12;default:throw new Error("mode:"+a)}}},getLostPoint:function(a){for(var b=a.getModuleCount(),c=0,d=0;b>d;d++)for(var e=0;b>e;e++){for(var f=0,g=a.isDark(d,e),h=-1;1>=h;h++)if(!(0>d+h||d+h>=b))for(var i=-1;1>=i;i++)0>e+i||e+i>=b||(0!=h||0!=i)&&g==a.isDark(d+h,e+i)&&f++;f>5&&(c+=3+f-5)}for(var d=0;b-1>d;d++)for(var e=0;b-1>e;e++){var j=0;a.isDark(d,e)&&j++,a.isDark(d+1,e)&&j++,a.isDark(d,e+1)&&j++,a.isDark(d+1,e+1)&&j++,(0==j||4==j)&&(c+=3)}for(var d=0;b>d;d++)for(var e=0;b-6>e;e++)a.isDark(d,e)&&!a.isDark(d,e+1)&&a.isDark(d,e+2)&&a.isDark(d,e+3)&&a.isDark(d,e+4)&&!a.isDark(d,e+5)&&a.isDark(d,e+6)&&(c+=40);for(var e=0;b>e;e++)for(var d=0;b-6>d;d++)a.isDark(d,e)&&!a.isDark(d+1,e)&&a.isDark(d+2,e)&&a.isDark(d+3,e)&&a.isDark(d+4,e)&&!a.isDark(d+5,e)&&a.isDark(d+6,e)&&(c+=40);for(var k=0,e=0;b>e;e++)for(var d=0;b>d;d++)a.isDark(d,e)&&k++;var l=Math.abs(100*k/b/b-50)/5;return c+=10*l}},n={glog:function(a){if(1>a)throw new Error("glog("+a+")");return n.LOG_TABLE[a]},gexp:function(a){for(;0>a;)a+=255;for(;a>=256;)a-=255;return n.EXP_TABLE[a]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},o=0;8>o;o++)n.EXP_TABLE[o]=1<<o;for(var o=8;256>o;o++)n.EXP_TABLE[o]=n.EXP_TABLE[o-4]^n.EXP_TABLE[o-5]^n.EXP_TABLE[o-6]^n.EXP_TABLE[o-8];for(var o=0;255>o;o++)n.LOG_TABLE[n.EXP_TABLE[o]]=o;c.prototype={get:function(a){return this.num[a]},getLength:function(){return this.num.length},multiply:function(a){for(var b=new Array(this.getLength()+a.getLength()-1),d=0;d<this.getLength();d++)for(var e=0;e<a.getLength();e++)b[d+e]^=n.gexp(n.glog(this.get(d))+n.glog(a.get(e)));return new c(b,0)},mod:function(a){if(this.getLength()-a.getLength()<0)return this;for(var b=n.glog(this.get(0))-n.glog(a.get(0)),d=new Array(this.getLength()),e=0;e<this.getLength();e++)d[e]=this.get(e);for(var e=0;e<a.getLength();e++)d[e]^=n.gexp(n.glog(a.get(e))+b);return new c(d,0).mod(a)}},d.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],d.getRSBlocks=function(a,b){var c=d.getRsBlockTable(a,b);if(void 0==c)throw new Error("bad rs block @ typeNumber:"+a+"/errorCorrectLevel:"+b);for(var e=c.length/3,f=[],g=0;e>g;g++)for(var h=c[3*g+0],i=c[3*g+1],j=c[3*g+2],k=0;h>k;k++)f.push(new d(i,j));return f},d.getRsBlockTable=function(a,b){switch(b){case k.L:return d.RS_BLOCK_TABLE[4*(a-1)+0];case k.M:return d.RS_BLOCK_TABLE[4*(a-1)+1];case k.Q:return d.RS_BLOCK_TABLE[4*(a-1)+2];case k.H:return d.RS_BLOCK_TABLE[4*(a-1)+3];default:return void 0}},e.prototype={get:function(a){var b=Math.floor(a/8);return 1==(1&this.buffer[b]>>>7-a%8)},put:function(a,b){for(var c=0;b>c;c++)this.putBit(1==(1&a>>>b-c-1))},getLengthInBits:function(){return this.length},putBit:function(a){var b=Math.floor(this.length/8);this.buffer.length<=b&&this.buffer.push(0),a&&(this.buffer[b]|=128>>>this.length%8),this.length++}};var p=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],q=function(){var a=function(a,b){this._el=a,this._htOption=b};return a.prototype.draw=function(a){function b(a,b){var c=document.createElementNS("http://www.w3.org/2000/svg",a);for(var d in b)b.hasOwnProperty(d)&&c.setAttribute(d,b[d]);return c}var c=this._htOption,d=this._el,e=a.getModuleCount();Math.floor(c.width/e),Math.floor(c.height/e),this.clear();var f=b("svg",{viewBox:"0 0 "+String(e)+" "+String(e),width:"100%",height:"100%",fill:c.colorLight});f.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),d.appendChild(f),f.appendChild(b("rect",{fill:c.colorDark,width:"1",height:"1",id:"template"}));for(var g=0;e>g;g++)for(var h=0;e>h;h++)if(a.isDark(g,h)){var i=b("use",{x:String(g),y:String(h)});i.setAttributeNS("http://www.w3.org/1999/xlink","href","#template"),f.appendChild(i)}},a.prototype.clear=function(){for(;this._el.hasChildNodes();)this._el.removeChild(this._el.lastChild)},a}(),r="svg"===document.documentElement.tagName.toLowerCase(),s=r?q:f()?function(){function a(){this._elImage.src=this._elCanvas.toDataURL("image/png"),this._elImage.style.display="block",this._elCanvas.style.display="none"}function b(a,b){var c=this;if(c._fFail=b,c._fSuccess=a,null===c._bSupportDataURI){var d=document.createElement("img"),e=function(){c._bSupportDataURI=!1,c._fFail&&_fFail.call(c)},f=function(){c._bSupportDataURI=!0,c._fSuccess&&c._fSuccess.call(c)};return d.onabort=e,d.onerror=e,d.onload=f,void(d.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==")}c._bSupportDataURI===!0&&c._fSuccess?c._fSuccess.call(c):c._bSupportDataURI===!1&&c._fFail&&c._fFail.call(c)}if(this._android&&this._android<=2.1){var c=1/window.devicePixelRatio,d=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(a,b,e,f,g,h,i,j){if("nodeName"in a&&/img/i.test(a.nodeName))for(var k=arguments.length-1;k>=1;k--)arguments[k]=arguments[k]*c;else"undefined"==typeof j&&(arguments[1]*=c,arguments[2]*=c,arguments[3]*=c,arguments[4]*=c);d.apply(this,arguments)}}var e=function(a,b){this._bIsPainted=!1,this._android=g(),this._htOption=b,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=b.width,this._elCanvas.height=b.height,a.appendChild(this._elCanvas),this._el=a,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._elImage=document.createElement("img"),this._elImage.style.display="none",this._el.appendChild(this._elImage),this._bSupportDataURI=null};return e.prototype.draw=function(a){var b=this._elImage,c=this._oContext,d=this._htOption,e=a.getModuleCount(),f=d.width/e,g=d.height/e,h=Math.round(f),i=Math.round(g);b.style.display="none",this.clear();for(var j=0;e>j;j++)for(var k=0;e>k;k++){var l=a.isDark(j,k),m=k*f,n=j*g;c.strokeStyle=l?d.colorDark:d.colorLight,c.lineWidth=1,c.fillStyle=l?d.colorDark:d.colorLight,c.fillRect(m,n,f,g),c.strokeRect(Math.floor(m)+.5,Math.floor(n)+.5,h,i),c.strokeRect(Math.ceil(m)-.5,Math.ceil(n)-.5,h,i)}this._bIsPainted=!0},e.prototype.makeImage=function(){this._bIsPainted&&b.call(this,a)},e.prototype.isPainted=function(){return this._bIsPainted},e.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},e.prototype.round=function(a){return a?Math.floor(1e3*a)/1e3:a},e}():function(){var a=function(a,b){this._el=a,this._htOption=b};return a.prototype.draw=function(a){for(var b=this._htOption,c=this._el,d=a.getModuleCount(),e=Math.floor(b.width/d),f=Math.floor(b.height/d),g=['<table style="border:0;border-collapse:collapse;">'],h=0;d>h;h++){g.push("<tr>");for(var i=0;d>i;i++)g.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+e+"px;height:"+f+"px;background-color:"+(a.isDark(h,i)?b.colorDark:b.colorLight)+';"></td>');g.push("</tr>")}g.push("</table>"),c.innerHTML=g.join("");var j=c.childNodes[0],k=(b.width-j.offsetWidth)/2,l=(b.height-j.offsetHeight)/2;k>0&&l>0&&(j.style.margin=l+"px "+k+"px")},a.prototype.clear=function(){this._el.innerHTML=""},a}();QRCode=function(a,b){if(this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:k.H},"string"==typeof b&&(b={text:b}),b)for(var c in b)this._htOption[c]=b[c];"string"==typeof a&&(a=document.getElementById(a)),this._android=g(),this._el=a,this._oQRCode=null,this._oDrawing=new s(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)},QRCode.prototype.makeCode=function(a){this._oQRCode=new b(h(a,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(a),this._oQRCode.make(),this._el.title=a,this._oDrawing.draw(this._oQRCode),this.makeImage()},QRCode.prototype.makeImage=function(){"function"==typeof this._oDrawing.makeImage&&(!this._android||this._android>=3)&&this._oDrawing.makeImage()},QRCode.prototype.clear=function(){this._oDrawing.clear()},QRCode.CorrectLevel=k}(),"object"!=typeof JSON&&(JSON={}),function(){"use strict";function f(a){return 10>a?"0"+a:a}function quote(a){return escapable.lastIndex=0,escapable.test(a)?'"'+a.replace(escapable,function(a){var b=meta[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function str(a,b){var c,d,e,f,g,h=gap,i=b[a];switch(i&&"object"==typeof i&&"function"==typeof i.toJSON&&(i=i.toJSON(a)),"function"==typeof rep&&(i=rep.call(b,a,i)),typeof i){case"string":return quote(i);case"number":return isFinite(i)?String(i):"null";case"boolean":case"null":return String(i);case"object":if(!i)return"null";if(gap+=indent,g=[],"[object Array]"===Object.prototype.toString.apply(i)){for(f=i.length,c=0;f>c;c+=1)g[c]=str(c,i)||"null";return e=0===g.length?"[]":gap?"[\n"+gap+g.join(",\n"+gap)+"\n"+h+"]":"["+g.join(",")+"]",gap=h,e}if(rep&&"object"==typeof rep)for(f=rep.length,c=0;f>c;c+=1)"string"==typeof rep[c]&&(d=rep[c],e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));else for(d in i)Object.prototype.hasOwnProperty.call(i,d)&&(e=str(d,i),e&&g.push(quote(d)+(gap?": ":":")+e));return e=0===g.length?"{}":gap?"{\n"+gap+g.join(",\n"+gap)+"\n"+h+"}":"{"+g.join(",")+"}",gap=h,e}}"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,b,c){var d;if(gap="",indent="","number"==typeof c)for(d=0;c>d;d+=1)indent+=" ";else"string"==typeof c&&(indent=c);if(rep=b,b&&"function"!=typeof b&&("object"!=typeof b||"number"!=typeof b.length))throw new Error("JSON.stringify");return str("",{"":a})}),"function"!=typeof JSON.parse&&(JSON.parse=function(text,reviver){function walk(a,b){var c,d,e=a[b];if(e&&"object"==typeof e)for(c in e)Object.prototype.hasOwnProperty.call(e,c)&&(d=walk(e,c),void 0!==d?e[c]=d:delete e[c]);return reviver.call(a,b,e)}var j;if(text=String(text),cx.lastIndex=0,cx.test(text)&&(text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})),/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return j=eval("("+text+")"),"function"==typeof reviver?walk({"":j},""):j;throw new SyntaxError("JSON.parse")})}(),bn=function(a){this.initWith(a)},bn.prototype={radix:24,maxMul:8,_class:bn,_b64codes:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",copy:function(){return new this._class(this)},initWith:function(a){var b,c=0,d=!1;switch(typeof a){case"object":this.limbs=a.limbs.slice(0);break;case"number":this.limbs=[a],this.normalize();break;case"string":for(a=a.replace(/^0x/,""),"-"==a.charAt(0)&&(d=!0,a=a.slice(1)),this.limbs=[],b=this.radix/4,c=0;c<a.length;c+=b)this.limbs.push(parseInt(a.substring(Math.max(a.length-c-b,0),a.length-c),16));break;default:this.limbs=[0]}if(d){for(c=0;c<this.limbs.length;c++)this.limbs[c]=-this.limbs[c];this.normalize()}return this},equals:function(a){"number"==typeof a&&(a=new this._class(a)),this.fix(),a.fix();
var b,c=0;for(b=0;b<this.limbs.length||b<a.limbs.length;b++)c|=this.getLimb(b)^a.getLimb(b);return 0===c},getLimb:function(a){return a>=this.limbs.length?0:this.limbs[a]},greaterEquals:function(a){"number"==typeof a&&(a=new this._class(a));var b,c,d,e=0,f=0;for(b=Math.max(this.limbs.length,a.limbs.length)-1;b>=0;b--)c=this.getLimb(b),d=a.getLimb(b),f|=d-c&~e,e|=c-d&~f;return(f|~e)>>>31},toString:function(){var a,b,c=this.print(),d="",e=c.limbs;for(a=0;a<c.limbs.length;a++){for(b=e[a].toString(16);a<c.limbs.length-1&&b.length<6;)b="0"+b;d=b+d}d=d.length%2==1?"0x0"+d:"0x"+d;var f=util.hexToBits(d);return util.bitsToString(f)},toHexString:function(){var a,b,c=this.print(),d="",e=c.limbs;for(a=0;a<c.limbs.length;a++){for(b=e[a].toString(16);a<c.limbs.length-1&&b.length<6;)b="0"+b;d=b+d}return"0x"+d},toBytes:function(){var a=this.toString(),b=util.stringToBits(a);return util.bitsToBytes(b).reverse()},toMyPaddedBytes:function(a){for(var b=this.toBytes();b.length<a;)b.push(0);for(;b.length>a;)b.pop();return b.reverse()},toPaddedBytes:function(a){for(var b=this.toBytes(),c=a.toBytes();b.length<c.length;)b.push(0);return b.reverse()},toTruncatedBytes:function(){for(var a=this.toBytes();0==a[a.length-1];)a.pop();return a},addM:function(a){"object"!=typeof a&&(a=new this._class(a));var b,c=this.limbs,d=a.limbs;for(b=c.length;b<d.length;b++)c[b]=0;for(b=0;b<d.length;b++)c[b]+=d[b];return this},pmulM:function(a){var b,c=this.limbs;for(b=0;b<c.length;b++)c[b]*=a;return this.normalize()},doubleM:function(){var a,b,c=0,d=this.radix,e=this.radixMask,f=this.limbs;for(a=0;a<f.length;a++)b=f[a],b=b+b+c,f[a]=b&e,c=b>>d;return c&&f.push(c),this},halveM:function(){var a,b,c=0,d=this.radix,e=this.limbs;for(a=e.length-1;a>=0;a--)b=e[a],e[a]=b+c>>1,c=(1&b)<<d;return e[e.length-1]||e.pop(),this},subM:function(a){"object"!=typeof a&&(a=new this._class(a));var b,c=this.limbs,d=a.limbs;for(b=c.length;b<d.length;b++)c[b]=0;for(b=0;b<d.length;b++)c[b]-=d[b];return this},mulM:function(a){"number"==typeof a&&(a=new this._class(a)),this.cnormalize(),a.cnormalize();var b,c,d,e=this.limbs,f=a.limbs,g=e.length,h=f.length,i=new this._class,j=i.limbs,k=this.maxMul;for(b=0;g+h>b;b++)j[b]=0;for(cl=j.length;b<j.length;b++)j[b]=0;for(b=0;g>b;b++){for(d=e[b],c=0;h>c;c++)j[b+c]+=d*f[c];--k||(k=this.maxMul,i.cnormalize())}return i.cnormalize()},sqrM:function(){this.cnormalize();var a,b,c,d,e=this.limbs,f=e.length,g=new this._class,h=g.limbs,i=this.maxMul;for(a=0;f+f>a;a++)h[a]=0;for(cl=h.length;a<h.length;a++)h[a]=0;for(a=0;f>a;a++){for(d=e[a],c=a+1;f>c;c++)h[a+c]+=d*e[c];--i||(i=this.maxMul,g.cnormalize())}for(g.cnormalize(),a=0;f+f>a;a++)h[a]+=h[a];for(a=0;f>a;a++)b=a+a,h[b]+=e[a]*e[a];return g.cnormalize()},mod:function(a){a=new bn(a).normalize();for(var b=new bn(this).normalize(),c=0;b.greaterEquals(a);c++)a.doubleM();for(;c>0;c--)a.halveM(),b.greaterEquals(a)&&b.subM(a).normalize();return b.trim()},div:function(a){a=new bn(a).normalize();for(var b=new bn(this).normalize(),c=0,d=new bn(1),e=new bn(0);b.greaterEquals(a);c++)d.doubleM(),a.doubleM();for(;c>0;c--)a.halveM(),d.halveM(),b.greaterEquals(a)&&(e.addM(d).normalize(),b.subM(a).normalize());return e},inverseMod:function(a){var b,c,d=new bn(1),e=new bn(0),f=new bn(this),g=new bn(a),h=1;if(!(1&a.limbs[0]))throw new cjct.error("invalid argument");do for(1&f.limbs[0]&&(f.greaterEquals(g)||(b=f,f=g,g=b,b=d,d=e,e=b),f.subM(g),f.normalize(),d.greaterEquals(e)||d.addM(a),d.subM(e)),f.halveM(),1&d.limbs[0]&&d.addM(a),d.normalize(),d.halveM(),c=h=0;c<f.limbs.length;c++)h|=f.limbs[c];while(h);if(!g.equals(1))throw new cjct.error("invalid arguments");return e},negative:function(){return this.normalize().trim(),this.limbs[this.limbs.length-1]<0},neg:function(){return new this._class(0).sub(this)},add:function(a){return this.copy().addM(a)},dbl:function(){return this.copy().doubleM()},hlv:function(){return this.copy().halveM()},sub:function(a){return this.copy().subM(a)},pmul:function(a){return this.copy().pmulM(a)},mul:function(a){return this.mulM(a).reduce()},square:function(){return this.sqrM().reduce()},power:function(a){"number"==typeof a?a=[a]:void 0!==a.limbs&&(a=a.normalize().limbs);var b,c,d=new this._class(1);for(b=a.length-1;b>=0;b--)for(c=bn.prototype.radix-1;c>=0;c--)d=d.square(),a[b]&1<<c&&(d=d.mul(this));return d},recode:function(a,b,c){var d,e,f=bn.prototype.radix,g=0;for(d=b-1;d>=0;d--)g+=g,e=c+d*a,g+=(this.limbs[Math.floor(e/f)]&1<<e%f)>>e%f;return g},glv:function(a,b,c){var d,e,f,g;for(f=new Array(2),g=new Array(2),d=0;2>d;d++)f[d]=new bn(0),g[d]=new bn,g[d]=b[d].negative()?this.mul(b[d].neg()).div(a).neg().normalize():this.mul(b[d]).div(a);for(f[0]=this,d=0;2>d;d++){for(e=0;2>e;e++)f[d]=f[d].sub(g[e].mul(c[e][d]));f[d].normalize().trim()}return f},gs:function(a,b,c){var d,e,f,g;for(f=new Array(4),g=new Array(4),d=0;4>d;d++)f[d]=new bn(0),g[d]=new bn,g[d]=b[d].negative()?this.mul(b[d].neg()).div(a).neg().normalize():this.mul(b[d]).div(a);for(f[0]=this,d=0;4>d;d++){for(e=0;4>e;e++)f[d]=f[d].sub(g[e].mul(c[e][d]));f[d].normalize().trim()}return f},trim:function(){var a,b=this.limbs;do a=b.pop();while(b.length&&0===a);return b.push(a),this},reduce:function(){return this.normalize()},print:function(){return this.normalize()},fix:function(){return this.normalize()},print:function(){return this.normalize()},normalize:function(){var a,b,c,d=0,e=(this.placeVal,this.ipv),f=this.limbs,g=f.length,h=this.radixMask;for(a=0;g>a||0!==d&&-1!==d;a++)b=(f[a]||0)+d,c=f[a]=b&h,d=(b-c)*e;return-1===d&&(f[a-1]-=this.placeVal),this},cnormalize:function(){var a,b,c,d=0,e=this.ipv,f=this.limbs,g=f.length,h=this.radixMask;for(a=0;g-1>a;a++)b=f[a]+d,c=f[a]=b&h,d=(b-c)*e;return f[a]+=d,this}},bn.fromBits=function(a){var b=this,c=new b,d=[],e=bitArray,f=this.prototype,g=Math.min(this.bitLength||4294967296,e.bitLength(a)),h=g%f.radix||f.radix;for(d[0]=e.extract(a,0,h);g>h;h+=f.radix)d.unshift(e.extract(a,h,f.radix));return c.limbs=d,c},bn.prototype.ipv=1/(bn.prototype.placeVal=Math.pow(2,bn.prototype.radix)),bn.prototype.radixMask=(1<<bn.prototype.radix)-1,bn.sparsePrime=function(a,b){function c(a){this.initWith(a),this.fix()}var d,e,f,g=c.prototype=new bn;for(f=g.modOffset=Math.ceil(e=a/g.radix),g.exponent=a,g.offset=[],g.factor=[],g.minOffset=f,g.fullMask=0,g.fullOffset=[],g.fullFactor=[],g.modulus=c.modulus=new bn(Math.pow(2,a)),g.fullMask=0|-Math.pow(2,a%g.radix),d=0;d<b.length;d++)g.offset[d]=Math.floor(b[d][0]/g.radix-e),g.fullOffset[d]=Math.ceil(b[d][0]/g.radix-e),g.factor[d]=b[d][1]*Math.pow(.5,a-b[d][0]+g.offset[d]*g.radix),g.fullFactor[d]=b[d][1]*Math.pow(.5,a-b[d][0]+g.fullOffset[d]*g.radix),g.modulus.addM(new bn(Math.pow(2,b[d][0])*b[d][1])),g.minOffset=Math.min(g.minOffset,-g.offset[d]);return g._class=c,g.modulus.cnormalize(),g.reduce=function(){var a,b,c,d,e=this.modOffset,f=this.limbs,g=this.offset,h=this.offset.length,i=this.factor;for(a=this.minOffset;f.length>e;){for(c=f.pop(),d=f.length,b=0;h>b;b++)f[d+g[b]]-=i[b]*c;a--,a||(f.push(0),this.cnormalize(),a=this.minOffset)}return this.cnormalize(),this},g._strongReduce=-1===g.fullMask?g.reduce:function(){var a,b,c=this.limbs,d=c.length-1;if(this.reduce(),d===this.modOffset-1){for(b=c[d]&this.fullMask,c[d]-=b,a=0;a<this.fullOffset.length;a++)c[d+this.fullOffset[a]]-=this.fullFactor[a]*b;this.normalize()}},g.fix=function(){var a,b;for(this._strongReduce(),this.addM(this.modulus),this.addM(this.modulus),this.normalize(),this._strongReduce(),b=this.limbs.length;b<this.modOffset;b++)this.limbs[b]=0;for(a=this.greaterEquals(this.modulus),b=0;b<this.limbs.length;b++)this.limbs[b]-=this.modulus.limbs[b]*a;return this.cnormalize(),this},g.print=function(){return this.fix()},g.inverse=function(){return this.inverseMod(this.modulus)},g.sqrt=function(){return this.power(this.modulus.add(1).hlv().hlv())},c.fromBits=bn.fromBits,c},bn.densePrime=function(a,b){function c(b){var c=new bn(a),d=c.limbs.length,e=new bn(b);if("number"==typeof b&&0!==b||"string"==typeof b){e.limbs=new Array(d).concat(e.limbs);for(var f=0;d>f;f++)e.limbs[f]=0;e=e.mod(c)}for(;!e.greaterEquals(0);)e.addM(c);for(;e.greaterEquals(c);)e.subM(c);e.cnormalize(),this.limbs=e.limbs.slice(0)}var d=c.prototype=new bn;return d.modulus=c.modulus=new bn(a),d.digit=c.digit=new bn(b).limbs[0],d._class=c,d.modulus.cnormalize(),d.reduce=function(){this.cnormalize();for(var a,b,c,d=this.limbs,e=this.modulus.limbs,f=e.length,g=bn.prototype.radixMask,h=bn.prototype.ipv,i=bn.prototype.maxMul-1,j=i,k=0;f>k;k++){for(var l=(d[k]&g)*this.digit&g,m=0;f>m;m++)d[k+m]+=e[m]*l;j--,j?(a=d[k],b=d[k]=a&g,c=(a-b)*h,d[k+1]+=c):(this.normalize(),j=i)}this.normalize(),this.limbs=new Array(f);for(var k=0;f>k;k++)this.limbs[k]=0;for(var k=0;k<d.length-f;k++)this.limbs[k]=d[k+f];for(;this.greaterEquals(this.modulus);)this.subM(this.modulus),this.cnormalize();return this.copy()},d.fix=function(){for(;!this.greaterEquals(new bn(0));)this.addM(this.modulus);for(;this.greaterEquals(this.modulus);)this.subM(this.modulus);return this.cnormalize()},d.print=function(){for(;this.greaterEquals(this.modulus);)this.subM(this.modulus);this.normalize().trim();var a=this.copy(),b=this.copy();b.limbs=new Array(2*this.modulus.limbs.length+1);for(var c=0;c<this.limbs.length;c++)b.limbs[c]=this.limbs[c];for(var c=this.limbs.length;c<b.limbs.length;c++)b.limbs[c]=0;b=b.reduce();for(var c=0;c<this.modulus.limbs.length;c++)a.limbs[c]=b.limbs[c];return a.trim()},d.inverse=function(){var a=this.copy();a=a.print(),a=a.inverseMod(this.modulus).normalize().trim();var b=new bn(this.modulus),d=b.limbs.length;a.limbs=new Array(d).concat(a.limbs);for(var e=0;d>e;e++)a.limbs[e]=0;for(a=a.mod(b);!a.greaterEquals(0);)a.addM(b);for(;a.greaterEquals(b);)a.subM(b);a.normalize(),a._class=c;for(var e=a.limbs.length;e<this.modulus.limbs.length;e++)a.limbs[e]=0;return a},d.sqrt=function(){return this.power(this.modulus.add(1).hlv().hlv())},c},bn.prime={p127:bn.sparsePrime(127,[[0,-1]]),p25519:bn.sparsePrime(255,[[0,-19]]),p192:bn.sparsePrime(192,[[0,-1],[64,-1]]),p224:bn.sparsePrime(224,[[0,1],[96,-1]]),p256:bn.sparsePrime(256,[[0,-1],[96,1],[192,1],[224,-1]]),p384:bn.sparsePrime(384,[[0,-1],[32,1],[96,-1],[128,-1]]),p521:bn.sparsePrime(521,[[0,-1]]),p254:bn.densePrime("0x2400000008702A0DB0BDDF647A6366D3243FD6EE18093EE1BE6623EF5C1B55B3","0x789E85")},bn.random=function(a,b){"object"!=typeof a&&(a=new bn(a));for(var c,d,e=a.limbs.length,f=a.limbs[e-1]+1,g=new bn;;){do c=random.randomWords(e,b),c[e-1]<0&&(c[e-1]+=4294967296);while(Math.floor(c[e-1]/f)===Math.floor(4294967296/f));for(c[e-1]%=f,d=0;e-1>d;d++)c[d]&=a.radixMask;if(g.limbs=c,!g.greaterEquals(a))return g}},ecc={},ecc.point=function(a,b,c,d){void 0===b?this.isIdentity=!0:(this.x=new a.field(b),this.y=new a.field(c),this.z=new a.field(void 0===d?1:d),this.isIdentity=!1),this.curve=a},ecc.point.prototype={precompute:function(){var a,b,c;if(void 0===this.multiples)for(c=this.dbl(),a=this.multiples=[new ecc.point(this.curve),this,c.toAffine()],b=3;11>b;b++)c=c.add(this),a.push(c.toAffine())},add:function(a){var b=this;if(b.curve!==a.curve)throw new cjct.error("points must be on the same curve to add them!");if(b.isIdentity)return a;if(a.isIdentity)return b;var c=b.z.square(),d=new b.curve.field(a.x.mul(c).sub(b.x)),e=new b.curve.field(c.mul(b.z).mul(a.y).sub(b.y));if(d.equals(0))return e.equals(0)?b.dbl():new ecc.point(b.curve);var f=d.square(),g=d.mul(f),h=b.x.mul(f);return x=new b.curve.field(e.square().sub(g).sub(h).sub(h)),h=new b.curve.field(h.sub(x)).mul(e),y=new b.curve.field(h.sub(b.y.mul(g))),z=b.z.mul(d),new ecc.point(this.curve,x,y,z)},neg:function(){return this.isIdentity?this:new ecc.point(this.curve,this.x,this.y.neg(),this.z)},sub:function(a){return this.isIdentity?a.neg():this.add(a.neg())},dbl:function(){if(this.isIdentity)return this;if(this.curve.a.equals(0)){var a=this.x.square(),b=this.y.square(),c=b.square(),d=this.z.square(),e=new this.curve.field(this.x.add(b).square().sub(a).sub(c)).dbl(),f=a.add(a).add(a),g=new this.curve.field(f.square().sub(e).sub(e));e=new this.curve.field(e.sub(g));var h=new this.curve.field(f.mul(e).sub(c.dbl().dbl().dbl())),i=this.y.mul(this.z).dbl()}else{var a=this.z.square(),b=this.y.square(),c=this.x.mul(b),d=new this.curve.field(this.x.sub(a)).mul(this.x.add(a));d=d.dbl().add(d),c=c.dbl().dbl();var g=new this.curve.field(d.square().sub(c.dbl())),i=new this.curve.field(this.y.add(this.z).square().sub(b).sub(a)),h=new this.curve.field(c.sub(g).mul(d).sub(b.square().dbl().dbl().dbl()))}return new ecc.point(this.curve,g,h,i)},toAffine:function(){if(this.isIdentity||this.z.equals(0)||this.z.undefined)return new ecc.point(this.curve);if(this.z.equals(1))return this;var a=this.z.inverse(),b=a.square();return new ecc.point(this.curve,this.x.mul(b),this.y.mul(b.mul(a)))},equals:function(a){var b=this.toAffine(),c=a.toAffine();return 1==b.isIdentity&&c.isIdentity?!0:b.x.equals(c.x)&&b.y.equals(c.y)},toString:function(){var a=this.toAffine();return"["+a.x.toString()+","+a.y.toString()+"]"},smul:function(a){var b,c,d=new ecc.point(this.curve);for("number"==typeof a?a=[a]:void 0!==a.limbs&&(a=a.normalize().limbs),b=a.length-1;b>=0;b--)for(c=bn.prototype.radix-1;c>=0;c--)d=d.dbl(),a[b]&1<<c&&(d=d.add(this));return d.toAffine()},mul:function(a,b){var c,d,e=new ecc.point(this.curve);if(void 0===b){var f,g,h,i,j;if("number"==typeof a?(f=3*a,f=Math.floor(f/2),a=Math.floor(a/2),a=[a],f=[f]):void 0!==a.limbs&&(a=a.normalize(),f=new bn(a),f=f.pmul(3),a=a.hlv().limbs,f=f.normalize().hlv().limbs),this.precompute(),void 0===this.multiples)for(c=f.length-1;c>=0;c--)for(d=bn.prototype.radix-1;d>=0;d--)e=e.dbl(),i=1<<d,g=f[c]&i,h=a[c]&i,g>h&&(e=e.add(this)),h>g&&(e=e.sub(this));else for(c=f.length-1;c>=0;c--)for(d=bn.prototype.radix-4;d>=0;d-=4)j=(f[c]>>d&15)-(a[c]>>d&15),e=e.dbl().dbl().dbl().dbl(),j>0&&(e=e.add(this.multiples[j])),0>j&&(e=e.sub(this.multiples[-j]))}else{var k=8,g=32;for(c=g-1;c>=0;c--)d=a.recode(g,k,c),e=e.dbl(),d>0&&(e=e.add(1==d?this:b[d-2]))}return e.toAffine()},mul2:function(a,b,c,d,e){var f=new ecc.point(this.curve);if(void 0===d){var g,h,i,j,k,l;if(a=a.normalize().limbs,c=c.normalize().limbs,a.length>c.length)for(i=a.length,g=c.length;i>g;g++)c[g]=0;else for(i=c.length,g=a.length;i>g;g++)a[g]=0;var m=this.add(b).toAffine();for(g=i-1;g>=0;g--)for(h=bn.prototype.radix-1;h>=0;h--)f=f.dbl(),l=1<<h,j=a[g]&l,k=c[g]&l,j?f=f.add(k?m:this):k&&(f=f.add(b))}else{var g,n,o,p=8,j=32;for(g=j-1;g>=0;g--)n=a.recode(j,p,g),o=c.recode(j,p,g),f=f.dbl(),n>0&&(f=f.add(1==n?this:d[n-2])),o>0&&(f=f.add(1==o?b:e[o-2]))}return f.toAffine()},endomorph:function(){return this.toAffine(),new ecc.point(this.curve,this.x.mul(ecc.constants.Beta),this.y)},GLVmul:function(a){var b,c,d,e,f;for(c=new Array(2),c[0]=ecc.constants.A,c[1]=ecc.constants.B,d=new Array(2),b=0;2>b;b++)d[b]=new Array(2);return d[0][0]=ecc.constants.A.copy().add(ecc.constants.B).normalize(),d[0][1]=ecc.constants.B,d[1][0]=ecc.constants.B,d[1][1]=ecc.constants.A.copy().neg().normalize(),e=a.glv(this.curve.r,c,d),f=this.endomorph(),e[1].negative()&&(e[1]=e[1].neg().normalize().trim(),f=f.neg()),e[0].negative()?(e[0]=e[0].neg().normalize().trim(),this.neg().mul2(e[0],f,e[1])):this.mul2(e[0],f,e[1])},isValid:function(){var a=this.z.square(),b=a.square(),c=b.mul(a);return this.y.square().equals(this.curve.b.mul(c).add(this.x.mul(this.curve.a.mul(b).add(this.x.square()))))}},ecc.point.random=function(a){for(var b,c;;){b=new a.field(new bn.random(a.field.modulus));var d=b.mul(b).mul(b).add(a.b).add(a.a.mul(b));if(c=d.sqrt(),c.square().equals(d))return new ecc.point(a,b,c);if(c.neg().square().equals(d))return new ecc.point(a,b,c.neg())}},ecc.point.fromString=function(a,b){var c=a.indexOf(","),d=a.substring(1,c);a[c]="/";var e=a.substring(c+1,a.length-1);return new ecc.point(b,util.bitsToHex(util.stringToBits(d)),util.bitsToHex(util.stringToBits(e)))},ecc.curve=function(a,b,c,d,e,f){this.field=a,this.t=new bn(b),this.r=a.prototype.modulus.sub(b),this.a=new a(c),this.b=new a(d),this.G=new ecc.point(this,new a(e),new a(f))},ecc.curves={c192:new ecc.curve(bn.prime.p192,"0x662107c8eb94364e4b2dd7ce",-3,"0x64210519e59c80e70fa7e9ab72243049feb8deecc146b9b1","0x188da80eb03090f67cbf20eb43a18800f4ff0afd82ff1012","0x07192b95ffc8da78631011ed6b24cdd573f977a11e794811"),c224:new ecc.curve(bn.prime.p224,"0xe95c1f470fc1ec22d6baa3a3d5c4",-3,"0xb4050a850c04b3abf54132565044b0b7d7bfd8ba270b39432355ffb4","0xb70e0cbd6bb4bf7f321390b94a03c1d356c21122343280d6115c1d21","0xbd376388b5f723fb4c22dfe6cd4375a05a07476444d5819985007e34"),c256:new ecc.curve(bn.prime.p256,"0x4319055358e8617b0c46353d039cdaae",-3,"0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b","0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296","0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),c384:new ecc.curve(bn.prime.p384,"0x389cb27e0bc8d21fa7e5f24cb74f58851313e696333ad68c",-3,"0xb3312fa7e23ee7e4988e056be3f82d19181d9c6efe8141120314088f5013875ac656398d8a2ed19d2a85c8edd3ec2aef","0xaa87ca22be8b05378eb1c71ef320ad746e1d3b628ba79b9859f741e082542a385502f25dbf55296c3a545e3872760ab7","0x3617de4a96262c6f5d9e98bf9292dc29f8f41dbd289a147ce9da3113b5f0b8c00a60b1ce1d7e819d7a431d7c90ea0e5f"),c254:new ecc.curve(bn.prime.p254,"0x600000000B4038130054634925303646",0,2,"0x2400000008702A0DB0BDDF647A6366D3243FD6EE18093EE1BE6623EF5C1B55B2","0x1")},ecc.constants={A:new bn("600000000B40381200546349162FEB83"),B:new bn("8000000007802561"),Beta:new bn("8A2767366FEB39F76D4080940EAFD73531BA5621CB403D1C721FF30A56F323C")},idak={_curve:ecc.curves.c254,FS:32,permits:!0,_var:new bn("0x4000000003C012B1"),_neg:!0,_hash:function(a){for(var b=new sha256,c=0;c<a.length;c++)b.update_byte(a[c]);for(var d=util.wordsToBytes(b.finalize());d.length<32;)bytes.push(0);for(;d.length>32;)bytes.pop();return d},_hashIt:function(a){for(var b=new sha256,c=0;c<a.length;c++)b.update_byte(a[c]);return util.bitsToString(util.bytesToBits(util.wordsToBytes(b.finalize())))},_hashToInteger:function(a,b){for(var c=new sha256,d=0;d<a.length;d++)c.update_byte(a[d]);c=util.wordsToBytes(c.finalize());var e=new bn(util.bitsToHex(util.bytesToBits(c)));return e.mod(b)},_hashToPoint1:function(a){for(var b=new sha256,c=0;c<a.length;c++)b.update_byte(a[c]);b=util.wordsToBytes(b.finalize());var d=new bn(util.bitsToHex(util.bytesToBits(b)));for(d=d.mod(this._curve.field.modulus);;){var e=new this._curve.field(d.toHexString()),f=e.mul(e).mul(e).add(this._curve.a.mul(e)).add(this._curve.b),g=f.sqrt();if(1&g.print().limbs[0]&&(g=g.neg()),g.square().equals(f))return new ecc.point(this._curve,e,g);d=d.add(new bn(1))}},_getSecret:function(){do var a=new bn.random(this._curve.r);while(a.equals(0));return a},getSecret:function(){return this._getSecret()},hashedID:function(a){return this._hashToPoint1(util.unicodeToBytes(a))},hashedTpID:function(a){return this._hashToPoint1(util.wordToBytes(util.today()).concat(util.unicodeToBytes(a)))},computeMPin_1c:function(a,b,c){var d,e=a.toAffine();return d=e.add(b).toAffine(),d=d.GLVmul(c).toString()},computeMPin_1x:function(a,b){var c=a.toAffine();return c=c.GLVmul(b).toString()},computeMPin_1b:function(a,b,c,d,e){var f=new ecc.point.fromString(d,this._curve),c=parseInt(c,10);if(f=f.add(a.smul(c)).toAffine(),this.permits){var g=new ecc.point.fromString(e,this._curve);f=f.add(g).toAffine()}return f=f.GLVmul(b).toString()},computeMPin_2:function(a,b,c,d){for(var e=c.inverseMod(this._curve.r),f=a.add(b).mul(e).mod(this._curve.r),g=util.bitsToBytes(util.stringToBits(d)),h=new Array(12),i=0;12>i;i++)h[i]=g.slice(i*this.FS,(i+1)*this.FS),h[i]=util.bitsToHex(util.bytesToBits(h[i]));var j=new fp2(h[0],h[1]),k=new fp2(h[8],h[9]),l=new fp2(h[6],h[7]),m=new fp6(j,k,l),n=new fp2(h[4],h[5]),o=new fp2(h[2],h[3]),p=new fp2(h[10],h[11]),q=new fp6(n,o,p),r=new fp12(m,q);if(!r.member())return["0",!1];var s=r.trace(),t=r.copy();t=t.frobenius();var u=t.trace();r=r.conj(),t=t.mul(r);var v=t.trace();t=t.mul(r);var w=t.trace(),x=this._curve.field.modulus.sub(this._curve.r).normalize().trim(),y=f.mod(x),z=f.div(x),A=s.xtr_pow2(u,v,w,y,z),g=A.els[0].els[0].toMyPaddedBytes(32).concat(A.els[0].els[1].toMyPaddedBytes(32)).concat(A.els[1].els[0].toMyPaddedBytes(32)).concat(A.els[1].els[1].toMyPaddedBytes(32)),B=this._hash(g).slice(0,16);return[util.bitsToString(util.bytesToBits(B)),!0]}},aes=function(a){this._RCON=[[0,0,0,0],[1,0,0,0],[2,0,0,0],[4,0,0,0],[8,0,0,0],[16,0,0,0],[32,0,0,0],[64,0,0,0],[128,0,0,0],[27,0,0,0],[54,0,0,0]];var b=a.length;if(4!=b&&6!=b&&8!=b)throw new cjct.error("invalid key length");this._key=a,this._rounds=6+this._key.length,this._SBOX=[],this._T=new Array(4),this._Tin=new Array(4);for(var c=0;4>c;c++)this._T[c]=[],this._Tin[c]=[];this._precompute(),this._schedule()},aes.prototype={encrypt:function(a,b){if(4!=a.length)throw new cjct.error("invalid block size");var c,d,e,f,g=this._w;c=this._T[0],d=this._T[1],e=this._T[2],f=this._T[3];var h,i,j,k,l=g[0],m=a[0]^l[0],n=a[1]^l[1],o=a[2]^l[2],p=a[3]^l[3];l=g[1];for(var q=[],r=g.length-1,s=1;r>s;s++)q=[n,o,p,m],h=c[m>>>24]^d[q[0]>>>16&255]^e[o>>>8&255]^f[255&q[2]]^l[0],i=c[n>>>24]^d[q[1]>>>16&255]^e[p>>>8&255]^f[255&q[3]]^l[1],j=c[o>>>24]^d[q[2]>>>16&255]^e[m>>>8&255]^f[255&q[0]]^l[2],k=c[p>>>24]^d[q[3]>>>16&255]^e[n>>>8&255]^f[255&q[1]]^l[3],m=h,n=i,o=j,p=k,l=g[s+1];m=4278190080&e[h>>>24]^16711680&f[i>>>16&255]^65280&c[j>>>8&255]^255&d[255&k]^l[0],n=4278190080&e[i>>>24]^16711680&f[j>>>16&255]^65280&c[k>>>8&255]^255&d[255&h]^l[1],o=4278190080&e[j>>>24]^16711680&f[k>>>16&255]^65280&c[h>>>8&255]^255&d[255&i]^l[2],p=4278190080&e[k>>>24]^16711680&f[h>>>16&255]^65280&c[i>>>8&255]^255&d[255&j]^l[3],b[0]=m,b[1]=n,b[2]=o,b[3]=p},_precompute:function(){var a,b,c,d,e,f,g=[];for(a=0;256>a;a++)g[a]=128&a?a<<1^283:a<<1,g[a]=a<<1^283*(a>>7);for(a=b=0;;){c=b^b<<1^b<<2^b<<3^b<<4,c=c>>8^255&c^99;var h=g[c],i=g[a],j=g[i],k=g[j];for(d=h<<24^c<<16^c<<8^c^h,e=(k^j^i)<<24^(k^a)<<16^(k^j^a)<<8^(k^i^a),f=0;4>f;f++)this._T[f][a]=d,this._Tin[f][c]=e,d=d<<24|d>>>8,e=e<<24|e>>>8;if(this._SBOX[a]=c,5==a)break;a?(a=i^g[g[g[k^i]]],b^=g[g[b]]):a=b=1}for(f=0;4>f;f++)this._T[f]=this._T[f].slice(0),this._Tin[f]=this._Tin[f].slice(0);this._SBOX=this._SBOX.slice(0)},_schedule:function(){this._w=[];for(var a=this._key,b=a.length,c=0,d=[],e=this._SBOX,f=0;b>f;f++)d[f]=a[f];for(var f=b;f<4*(this._rounds+1);f++){var g=d[f-1];f%b==0?(g=e[g>>>16&255]<<24^e[g>>>8&255]<<16^e[255&g]<<8^e[g>>>24]^this._RCON[c+1][0]<<24,c++):8==b&&f%b==4&&(g=e[g>>>24]<<24^e[g>>>16&255]<<16^e[g>>>8&255]<<8^e[255&g]),d[f]=d[f-b]^g}for(var h=d.length/4,f=0;h>f;f++)this._w[f]=[],this._w[f][0]=d[4*f],this._w[f][1]=d[4*f+1],this._w[f][2]=d[4*f+2],this._w[f][3]=d[4*f+3]}},sha256=function(){this.k[0]||this.precompute(),this.initialize()},sha256.prototype={init:[],k:[],precompute:function(){function a(a){return 4294967296*(a-Math.floor(a))|0}var b,c=2,d=0;a:for(;64>d;c++){for(b=2;c>=b*b;b++)if(c%b==0)continue a;8>d&&(this.init[d]=a(Math.pow(c,.5))),this.k[d]=a(Math.pow(c,1/3)),d++}},initialize:function(){this.h=this.init.slice(0),this.word_buffer=[],this.bit_buffer=0,this.bits_buffered=0,this.length=0,this.length_upper=0},block:function(a){var b,c,d=a.slice(0),e=this.h,f=this.k,g=e[0],h=e[1],i=e[2],j=e[3],k=e[4],l=e[5],m=e[6],n=e[7];for(b=0;64>b;b++){if(16>b)c=d[b];else{var o=d[b+1&15],p=d[b+14&15];c=d[15&b]=(o>>>7^o>>>18^o>>>3^o<<25^o<<14)+(p>>>17^p>>>19^p>>>10^p<<15^p<<13)+d[15&b]+d[b+9&15]|0}c+=n+(k>>>6^k>>>11^k>>>25^k<<26^k<<21^k<<7)+(m^k&(l^m))+f[b],n=m,m=l,l=k,k=j+c|0,j=i,i=h,h=g,g=c+(h&i^j&(h^i))+(h>>>2^h>>>13^h>>>22^h<<30^h<<19^h<<10)|0}e[0]+=g,e[1]+=h,e[2]+=i,e[3]+=j,e[4]+=k,e[5]+=l,e[6]+=m,e[7]+=n},update_word_big_endian:function(a){var b;(b=this.bits_buffered)?(this.word_buffer.push(a>>>32-b^this.bit_buffer),this.bit_buffer=a<<b):this.word_buffer.push(a),this.length+=32,0==this.length&&this.length_upper++,16==this.word_buffer.length&&(this.block(this.word_buffer),this.word_buffer=[])},update_word_little_endian:function(a){a=a>>>16^a<<16,a=a>>>8&16711935^a<<8&4278255360,this.update_word_big_endian(a)},update_words_big_endian:function(a){for(var b=0;b<a.length;b++)this.update_word_big_endian(a[b])},update_words_little_endian:function(a){for(var b=0;b<a.length;b++)this.update_word_little_endian(a[b])},update_byte:function(a){this.bit_buffer^=(255&a)<<24-this.bits_buffered,this.bits_buffered+=8,32==this.bits_buffered&&(this.bits_buffered=0,this.update_word_big_endian(this.bit_buffer),this.bit_buffer=0)},update_string:function(){throw new cjct.error("not yet implemented")},finalize:function(){var a,b=this.word_buffer;for(b.push(this.bit_buffer^1<<31-this.bits_buffered),a=b.length+2;15&a;a++)b.push(0);for(b.push(this.length_upper),b.push(this.length+this.bits_buffered);b.length;)this.block(b.splice(0,16));var c=this.h;return this.initialize(),c}},sha256.hash_words_big_endian=function(a){for(var b=new sha256,c=0;c<=a.length-16;c+=16)b.block(a.slice(c,c+16));return b.length=c<<5,c<a.length&&b.update_words_little_endian(a.slice(c)),b.finalize()},sha256.hash_words_little_endian=function(a){for(var b=a.slice(0),c=0;c<b.length;c++)b[c]=b[c]>>>16^b[c]<<16,b[c]=b[c]>>>8&16711935^b[c]<<8&4278255360;return sha256.hash_words_big_endian(b)},function(a,b,c,d,e,f,g){function h(a){var b,d,e=this,f=a.length,g=0,h=e.i=e.j=e.m=0;for(e.S=[],e.c=[],f||(a=[f++]);c>g;)e.S[g]=g++;for(g=0;c>g;g++)b=e.S[g],h=k(h+b+a[g%f]),d=e.S[h],e.S[g]=d,e.S[h]=b;e.g=function(a){var b=e.S,d=k(e.i+1),f=b[d],g=k(e.j+f),h=b[g];b[d]=h,b[g]=f;for(var i=b[k(f+h)];--a;)d=k(d+1),f=b[d],g=k(g+f),h=b[g],b[d]=h,b[g]=f,i=i*c+b[k(f+h)];return e.i=d,e.j=g,i},e.g(c)}function i(a,b,c,d,e){if(c=[],e=typeof a,b&&"object"==e)for(d in a)if(d.indexOf("S")<5)try{c.push(i(a[d],b-1))}catch(f){}return c.length?c:a+("string"!=e?"\x00":"")}function j(a,b,c,d){for(a+="",c=0,d=0;d<a.length;d++)b[k(d)]=k((c^=19*b[k(d)])+a.charCodeAt(d));a="";for(d in b)a+=String.fromCharCode(b[d]);return a}function k(a){return a&c-1}b.seedrandom=function(k,l){var m,n=[];return k=j(i(l?[k,a]:arguments.length?k:[(new Date).getTime(),a,window],3),n),m=new h(n),j(m.S,a),b.random=function(){for(var a=m.g(d),b=g,h=0;e>a;)a=(a+h)*c,b*=c,h=m.g(1);for(;a>=f;)a/=2,b/=2,h>>>=1;return(a+h)/b},k},g=b.pow(c,d),e=b.pow(2,e),f=2*e,j(b.random(),a)}([],Math,256,6,52),random={NOT_READY:0,READY:1,REQUIRES_RESEED:2,randomWord:function(a){return this.random_words(1,a)[0]},randomWords:function(a,b){var c,d=[],e=this.isReady(b);if(e&this.NOT_READY)throw"random: generator isn't seeded!";for(e&this.REQUIRES_RESEED&&this._reseedFromPools(!(e&this.READY)),c=0;a>c;c+=4){(c+1)%this._max_words_per_burst==0&&this._gate();var f=this._gen_4_words();d.push(f[0],f[1],f[2],f[3])}return this._gate(),d.slice(0,a)},setDefaultParanoia:function(a){this._default_paranoia=a},addEntropy:function(a,b,c){c=c||"user";var d,e=this._collector_ids[c]||(this._collector_ids[c]=this._collector_id_next++),f=0,g=(new Date).valueOf(),h=this._robins[c];switch(void 0==h&&(h=this._robins[c]=0),this._robins[c]=(this._robins[c]+1)%this._pools.length,typeof a){case"number":a=[a],f=1;break;case"object":if(!b)for(b=0,d=0;d<a.length;d++)for(var i=a[d];i>0;)b++,i>>>=1;this._pools[h].update_words_big_endian([e,this._event_id++,f||2,b,g,a.length].concat(a));break;case"string":b||(b=a.length),this._pools[h].update_words_big_endian([e,this._event_id++,3,b,g,a.length]),this._pools[h].update_string(a);break;default:throw new cjct.error("invalid argument")}var j=this.isReady();this._pool_entropy[h]+=b,this._pool_strength+=b,j==this.NOT_READY&&this.isReady()!=this.NOT_READY&&this._fireEvent("seeded",Math.max(this._strength,this._pool_strength)),j==this.NOT_READY&&this._fireEvent("progress",this.getProgress())},isReady:function(a){var b,c=this._PARANOIA_LEVELS[a?a:this._default_paranoia];return b=this._strength&&this._strength>=c?this._pool_entropy[0]>this._BITS_PER_RESEED&&(new Date).valueOf()>this._next_reseed?this.REQUIRES_RESEED|this.READY:this.READY:this._pool_strength>c?this.REQUIRES_RESEED|this.NOT_READY:this.NOT_READY},getProgress:function(a){var b=this._PARANOIA_LEVELS[a?a:this._default_paranoia];return this._strength>=b?1:this._pool_strength>b?1:this._pool_strength/b},startCollectors:function(){if(!this._collectors_started){if(window.addEventListener)window.addEventListener("load",this._loadTimeCollector,!1),window.addEventListener("mousemove",this._mouseCollector,!1);else{if(!document.attachEvent)throw"can't attach event";document.attachEvent("onload",this._loadTimeCollector),document.attachEvent("onmousemove",this._mouseCollector)}this._collectors_started=!0}},stopCollectors:function(){this._collectors_started&&(window.removeEventListener?(window.removeEventListener("load",this._loadTimeCollector),window.removeEventListener("mousemove",this._mouseCollector)):window.detachEvent&&(window.detachEvent("onload",this._loadTimeCollector),window.detachEvent("onmousemove",this._mouseCollector)),this._collectors_started=!1)},addEventListener:function(a,b){this._callbacks[a][this._callback_i++]=b},removeEventListener:function(a,b){var c,d,e=this._callbacks[a],f=[];for(d in e)e.hasOwnProperty[d]&&e[d]===b&&f.push(d);for(c=0;c<f.length;c++)d=js[c],delete e[d]},_pools:[new sha256],_pool_entropy:[0],_reseed_count:0,_robins:{},_event_id:0,_collector_ids:{},_collector_id_next:0,_strength:0,_pool_strength:0,_next_reseed:0,_key:[0,0,0,0,0,0,0,0],_counter:[0,0,0,0],_cipher:void 0,_default_paranoia:6,_collectors_started:!1,_callbacks:{progress:{},seeded:{}},_callback_i:0,_MAX_WORDS_PER_BURST:65536,_PARANOIA_LEVELS:[0,48,64,96,128,192,256,384,512,768,1024],_MILLISECONDS_PER_RESEED:100,_BITS_PER_RESEED:80,_gen_4_words:function(){for(var a=[],b=0;3>b&&!++this._counter[b];b++);return this._cipher.encrypt(this._counter,a),a},_gate:function(){this._key=this._gen_4_words().concat(this._gen_4_words()),this._cipher=new aes(this._key)},_reseed:function(a){this._key=sha256.hash_words_big_endian(this._key.concat(a)),this._cipher=new aes(this._key);for(var b=0;3>b&&!++this._counter[b];b++);},_reseedFromPools:function(a){var b=[],c=0;this._next_reseed=(new Date).valueOf()+this._MILLISECONDS_PER_RESEED;for(var d=0;d<this._pools.length&&(b=b.concat(this._pools[d].finalize()),c+=this._pool_entropy[d],this._pool_entropy[d]=0,a||!(this._reseed_count&1<<d));d++);this._reseed_count>=1<<this._pools.length&&(this._pools.push(new sha256),this._pool_entropy.push(0)),this._pool_strength-=c,c>this._strength&&(this._strength=c),this._reseed_count++,this._reseed(b)},_mouseCollector:function(a){var b=a.x||a.clientX||a.offsetX,c=a.y||a.clientY||a.offsetY;random.addEntropy([b,c],2,"mouse")},_loadTimeCollector:function(){var a=new Date;random.addEntropy(a,2,"loadtime")},_fireEvent:function(a,b){var c,d=random._callbacks[a],e=[];for(c in d)d.hasOwnProperty(c)&&e.push(d[c]);for(c=0;c<e.length;c++)e[c](b)}},util={},util.today=function(){var a=new Date;return Math.floor(a.getTime()/864e5)},util.hex=function(a){var b,c="",d="0123456789ABCDEF";for(b=0;8>b;b++){var e=15&a;c=d.substring(e,e+1)+c,a>>>=4}return c},util.hexall=function(a){var b,c="";for(b=0;b<a.length;b++)b%4==0?c+="<br/>\n":b&&(c+=" "),c+=util.hex(a[b]);return c},util.unicodeToBytes=function(a){for(var b=[],c=0;c<a.length;c++)if(a.charCodeAt(c)<=127)b.push(a.charCodeAt(c));else for(var d=encodeURIComponent(a.charAt(c)).substr(1).split("%"),e=0;e<d.length;e++)b.push(parseInt(d[e],16));return b},util.bytesToUnicode=function(a){for(var b="",c=0;c<a.length;c++)b+=a[c]<=127?37===a[c]?"%25":String.fromCharCode(a[c]):"%"+a[c].toString(16).toUpperCase();return decodeURIComponent(b)},util.wordsToBytes=function(a){for(var b=255,c=[],d=0;d<a.length;d++)for(var e=4*d,f=0;4>f;f++)c[e+f]=(a[d]&b<<8*(3-f))>>>8*(3-f);return c},util.wordToBytes=function(a){for(var b=255,c=[],d=0;4>d;d++)c[d]=(a&b<<8*(3-d))>>>8*(3-d);return c},util.bytesToWords=function(a){for(var b=a.slice(),c=[];b.length%4!=0;)b.push(0);for(var d=Math.floor(b.length/4),e=0;d>e;e++)c[e]=b[(e<<2)+3]|b[(e<<2)+2]<<8|b[(e<<2)+1]<<16|b[e<<2]<<24;return c},util.fixBytesLen=function(a,b){for(var c=a.slice(0);c.length>b;)c.shift();for(;c.length<b;)c.unshift(0);return c},util._chars="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",util._clamp=function(a,b){if(32*a.length<b)return a;
a=a.slice(0,Math.ceil(b/32));var c=a.length;return b=31&b,c>0&&b&&(a[c-1]=util._partial(b,a[c-1]&2147483648>>b-1,1)),a},util._getPartial=function(a){return Math.round(a/1099511627776)||32},util._bitLength=function(a){var b,c=a.length;return 0===c?0:(b=a[c-1],32*(c-1)+util._getPartial(b))},util._partial=function(a,b,c){return 32===a?b:(c?0|b:b<<32-a)+1099511627776*a},util.bitsToString=function(a,b){var c,d="",e=0,f=util._chars,g=0,h=util._bitLength(a);for(c=0;6*d.length<h;)d+=f.charAt((g^a[c]>>>e)>>>26),6>e?(g=a[c]<<6-e,e+=26,c++):(g<<=6,e-=6);for(;3&d.length&&!b;)d+="=";return d},util.stringToBits=function(a){a=a.replace(/\s|=/g,"");var b,c,d=[],e=0,f=util._chars,g=0;for(b=0;b<a.length;b++){if(c=f.indexOf(a.charAt(b)),0>c)throw new cjct.error("invalid format!");e>26?(e-=26,d.push(g^c>>>e),g=c<<32-e):(e+=6,g^=c<<32-e)}return 56&e&&d.push(util._partial(56&e,g,1)),d},util.bitsToBytes=function(a){var b,c,d=[],e=util._bitLength(a);for(b=0;e/8>b;b++)0===(3&b)&&(c=a[b/4]),d.push(c>>>24),c<<=8;return d},util.bytesToBits=function(a){var b,c=[],d=0;for(b=0;b<a.length;b++)d=d<<8|a[b],3===(3&b)&&(c.push(d),d=0);return 3&b&&c.push(util._partial(8*(3&b),d)),c},util.bitsToHex=function(a){var b,c="";for(b=0;b<a.length;b++)c+=((0|a[b])+0xf00000000000).toString(16).substr(4);return"0x"+c.substr(0,util._bitLength(a)/4)},util.hexToBits=function(a){var b,c,d=[];for(a=a.replace(/\s|0x/g,""),c=a.length,a+="00000000",b=0;b<a.length;b+=8)d.push(0^parseInt(a.substr(b,8),16));return util._clamp(d,4*c)},util.bitsToHexNew=function(a){var b,c="";for(b=0;b<a.length;b++)c+=((0|a[b])+0xf00000000000).toString(16).substr(4);return c.substr(0,util._bitLength(a)/4)},util.hexToBitsNew=function(a){var b,c,d=[];for(c=a.length,a+="00000000",b=0;b<a.length;b+=8)d.push(0^parseInt(a.substr(b,8),16));return util._clamp(d,4*c)};var cjct={hash:sha256,random:random,bn:bn,ecc:ecc,idak:idak,util:util,error:function(a){this.toString=function(){return"ERROR: "+this.message},this.message=a}};MPIN_LOADED=!0;